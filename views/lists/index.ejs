<% layout('layouts/boilerplate') %>


<div class="row text-center">
	<h2 class="">Lists</h2>
	<form action="" method="GET" id="search-lists">
		<div class="form-group row justify-content-center">
			<div class="col-sm-5 p-1">
				<input
					type="text"
					class="form-control border-info"
					placeholder="search lists"
					name="searchString"
				/>
			</div>
		</div>
		<div class="form-check-inline">
			By:
			<input
				class="form-check-input ms-3"
				type="radio"
				name="searchBy"
				id="list-title"
				checked
				value="title"
			/>
			<label class="form-check-label" for="list-title"> Title </label>
		</div>
		<div class="form-check-inline">
			<input
				class="form-check-input"
				type="radio"
				name="searchBy"
				id="list-creator"
				value="creator"
			/>
			<label class="form-check-label" for="list-creator"> Creator </label>
		</div>
		<div class="form-check-inline">
			<input
				class="form-check-input"
				type="radio"
				name="searchBy"
				id="list-items"
				value="items"
			/>
			<label class="form-check-label" for="list-items"> Items </label>
		</div>
	</form>
	<div class="row">
		<div class="col-md-4 m-auto d-flex justify-content-around mt-3">
			<button form="search-parties" type="submit" class="btn btn-success">
				Search
			</button>
			<a href="/lists/new" class="btn btn-primary">New List</a>
		</div>
	</div>
</div>


<div class="row justify-content-center mt-3">
	<% if (typeof(search) !== 'undefined') { %>
	<p class="fst-italic text-center text-muted">Search Results:</p>
	<% } else { %>
	<p class="fst-italic text-center text-muted">Recently created:</p>
	<% } %> <% for (const list of lists) { %>
	<div class="col-md-5">
		<div class="card mb-3">
			<div class="card-body py-0">
				<h4 class="card-title mt-3"><%= list.title %></h4>
				<p>
					<a
						href="/users/<%= list.creator._id %>/profile"
						class="link-secondary"
					>
						- <%= list.creator.displayName %>
					</a>
				</p>
				<ul class="list-group mb-3">
					<% for (const item of list.showThreeItems) { %>
					<li class="list-group-item">
						<img src="/assets/icons8-present-60.png" class="icon-present" />
						<% if (item.link) { %>
						<a href="<%= item.link %>" target="_blank">
							<%= item.description %>
						</a>
						<% } else { %>
						<span> <%= item.description %></span>
						<% } %>
					</li>

					<% } %>
				</ul>
				<div class="d-flex justify-content-between align-items-center">
					<% if (list.items.length > 2) { %>
					<a href="/lists/<%= list._id %>" class="btn btn-danger mb-3"
						>More...
					</a>
					<% } else { %>
					<a href="/lists/<%= list._id %>" class="btn btn-danger mb-3">View</a>
					<% } %>
					<div class="text-muted text-small text-center">
						<p class="mb-0">updated</p>
						<p class="updatedAt"><%= list.updatedAt %></p>
					</div>
				</div>
			</div>
		</div>
	</div>
	<% } %>
</div>
